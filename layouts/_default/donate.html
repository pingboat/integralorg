{{ define "styles" }}
/* Donate Page Styles - EXACT from homepage */
.donate-page-section {
    background: #faf8f3;
    padding: 120px 0 80px;
}

/* Donate Section - Ultra Compact & Elegant - EXACT from homepage */
.donate-container-main {
    max-width: 600px;
    margin: 0 auto;
    padding: 0 5%;
}

.donate-intro-text {
    text-align: center;
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 1.75rem;
    color: #374151;
    font-weight: 400;
}

.donation-card-main {
    background: white;
    border-radius: 6px;
    overflow: hidden;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
    border: 1px solid #e5e7eb;
}

.toggle-buttons-main {
    display: grid;
    grid-template-columns: 1fr 1fr;
    border-bottom: 1px solid #e5e7eb;
}

.toggle-btn-main {
    padding: 0.875rem;
    border: none;
    background: white;
    font-size: 0.8125rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    color: #6b7280;
    font-family: 'Plus Jakarta Sans', sans-serif;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.toggle-btn-main:first-child {
    border-right: 1px solid #e5e7eb;
}

.toggle-btn-main.active {
    background: #FFC700;
    color: #1f2937;
}

.card-content-main {
    padding: 1.75rem 1.75rem;
}

.section-title-main {
    font-size: 1.125rem;
    font-weight: 400;
    margin-bottom: 1.25rem;
    text-align: center;
    color: #1f2937;
}

.amount-grid-main {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.625rem;
    margin-bottom: 0.625rem;
}

.amount-btn-main {
    padding: 1rem 0.625rem;
    border: 1px solid #d1d5db;
    background: #f9fafb;
    border-radius: 4px;
    font-size: 1.375rem;
    font-weight: 400;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: #374151;
    text-align: center;
}

.amount-btn-main:hover {
    background: #ffffff;
    border-color: #9ca3af;
}

.amount-btn-main.selected {
    background: #FFC700;
    border-color: #FFC700;
    color: #1f2937;
    font-weight: 500;
}

.amount-label-main {
    font-size: 0.6875rem;
    color: #9ca3af;
    font-weight: 400;
    display: block;
    margin-top: 0.125rem;
    text-transform: uppercase;
    letter-spacing: 0.025em;
}

.other-amount-row-main {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.625rem;
    margin-bottom: 1.25rem;
}

.other-amount-main {
    padding: 1rem 0.625rem;
    border: 1px solid #d1d5db;
    background: #f9fafb;
    border-radius: 4px;
    font-size: 0.9375rem;
    font-weight: 400;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: #9ca3af;
    text-align: center;
}

.other-amount-main:hover {
    background: #ffffff;
    border-color: #9ca3af;
}

.other-amount-main.selected {
    background: #FFC700;
    border-color: #FFC700;
    color: #1f2937;
    font-weight: 500;
}

.donor-form-main {
    display: none;
    margin-top: 1.25rem;
    padding-top: 1.25rem;
    border-top: 1px dashed #d1d5db;
}

.donor-form-main.active {
    display: block;
}

.form-group-main {
    margin-bottom: 0.875rem;
}

.form-label-main {
    display: block;
    font-weight: 600;
    margin-bottom: 0.375rem;
    color: #374151;
    font-size: 0.8125rem;
}

.form-input-main {
    width: 100%;
    padding: 0.625rem;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    font-size: 0.875rem;
    font-family: 'Plus Jakarta Sans', sans-serif;
    transition: all 0.2s;
}

.form-input-main:focus {
    outline: none;
    border-color: #6b7280;
}

.submit-btn-main {
    width: 100%;
    padding: 0.875rem;
    background: #FFC700;
    border: none;
    border-radius: 4px;
    font-size: 0.9375rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'Plus Jakarta Sans', sans-serif;
    color: #1f2937;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.submit-btn-main:hover {
    background: #E6B300;
}

.submit-btn-main:disabled {
    background: #e5e7eb;
    cursor: not-allowed;
}

.impact-text-main {
    text-align: center;
    padding: 1.25rem 1rem;
    border-top: 1px dashed #d1d5db;
    margin-top: 1.25rem;
    font-size: 0.875rem;
    line-height: 1.6;
    color: #4b5563;
}

.impact-amount-main {
    font-weight: 700;
    color: #1f2937;
}

.impact-highlight-main {
    font-weight: 700;
    color: #2d5016;
}

.security-notice-main {
    text-align: center;
    font-size: 0.75rem;
    color: #9ca3af;
    margin-top: 1.25rem;
    line-height: 1.5;
}

.security-notice-main svg {
    width: 12px;
    height: 12px;
    vertical-align: middle;
    margin-right: 4px;
}

.security-notice-main a {
    color: #9ca3af;
    text-decoration: underline;
}

.transparency-banner-main {
    background: #fef3e2;
    border: 2px solid #f59e0b;
    border-radius: 8px;
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-top: 1.75rem;
}

.circle-badge-main {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: white;
    border: 5px solid #2d5016;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.circle-number-main {
    font-size: 2rem;
    font-weight: 700;
    color: #2d5016;
    line-height: 1;
}

.circle-percent-main {
    font-size: 1.25rem;
    color: #2d5016;
    line-height: 1;
}

.transparency-text-main {
    flex: 1;
    font-size: 0.875rem;
    line-height: 1.6;
    color: #4b5563;
}

.transparency-text-main strong {
    font-weight: 700;
    color: #1f2937;
}

.loading-main {
    display: none;
    text-align: center;
    padding: 1rem;
    margin-top: 1rem;
}

.loading-main.active {
    display: block;
}

.spinner-main {
    border: 3px solid #e5e7eb;
    border-top: 3px solid #FFC700;
    border-radius: 50%;
    width: 28px;
    height: 28px;
    animation: spin-main 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin-main {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Modal Styles */
.modal-overlay-main {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 2000;
    align-items: center;
    justify-content: center;
}

.modal-overlay-main.active {
    display: flex;
}

.modal-content-main {
    background: white;
    padding: 1.75rem;
    border-radius: 6px;
    max-width: 320px;
    width: 90%;
}

.modal-title-main {
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: #1f2937;
}

.custom-input-main {
    width: 100%;
    padding: 0.875rem;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    font-size: 1.375rem;
    font-weight: 600;
    font-family: 'Plus Jakarta Sans', sans-serif;
    margin-bottom: 1rem;
    text-align: center;
}

.custom-input-main:focus {
    outline: none;
    border-color: #6b7280;
}

.modal-buttons-main {
    display: flex;
    gap: 0.625rem;
}

.modal-btn-main {
    flex: 1;
    padding: 0.75rem;
    border: none;
    border-radius: 4px;
    font-size: 0.8125rem;
    font-weight: 600;
    cursor: pointer;
    font-family: 'Plus Jakarta Sans', sans-serif;
    transition: all 0.2s;
    text-transform: uppercase;
    letter-spacing: 0.025em;
}

.modal-btn-cancel-main {
    background: #f3f4f6;
    color: #374151;
}

.modal-btn-confirm-main {
    background: #FFC700;
    color: #1f2937;
}

@media (max-width: 768px) {
    .donate-page-section {
        padding: 100px 0 60px;
    }
    .donate-container-main { max-width: 100%; }
    .donate-intro-text { font-size: 0.9375rem; margin-bottom: 1.5rem; }
    .card-content-main { padding: 1.5rem 1.25rem; }
    .section-title-main { font-size: 1rem; margin-bottom: 1rem; }
    .amount-grid-main { grid-template-columns: repeat(2, 1fr); }
    .amount-btn-main { padding: 0.875rem 0.5rem; font-size: 1.25rem; }
    .other-amount-row-main { grid-template-columns: 1fr; }
    .transparency-banner-main {
        flex-direction: column;
        text-align: center;
        padding: 1.25rem;
        gap: 1.25rem;
    }
    .circle-badge-main { width: 70px; height: 70px; border-width: 4px; }
    .circle-number-main { font-size: 1.75rem; }
    .circle-percent-main { font-size: 1.125rem; }
    .transparency-text-main { font-size: 0.8125rem; }
}
{{ end }}

{{ define "main" }}
<section class="donate-page-section">
    <div class="donate-container-main">
        <p class="donate-intro-text">
            Our work to end poverty, and address unemployment and the impact of climate change in North East India needs your support. You can help preserve traditional silk crafts, create dignified livelihoods, and build climate resilience — especially for artisan families and indigenous communities.
        </p>
        
        <div class="donation-card-main">
            <div class="toggle-buttons-main">
                <button class="toggle-btn-main" id="onceBtnMain">GIVE ONCE</button>
                <button class="toggle-btn-main active" id="monthlyBtnMain">MONTHLY</button>
            </div>
            
            <div class="card-content-main">
                <h2 class="section-title-main" id="sectionTitleMain">Choose an amount to give per month</h2>
                
                <div class="amount-grid-main">
                    <button class="amount-btn-main" data-amount="500">
                        ₹500 <span class="amount-label-main">INR/mo</span>
                    </button>
                    <button class="amount-btn-main" data-amount="1500">
                        ₹1,500 <span class="amount-label-main">INR/mo</span>
                    </button>
                    <button class="amount-btn-main selected" data-amount="3000">
                        ₹3,000 <span class="amount-label-main">INR/mo</span>
                    </button>
                </div>
                
                <div class="other-amount-row-main">
                    <button class="amount-btn-main" data-amount="5000">
                        ₹5,000 <span class="amount-label-main">INR/mo</span>
                    </button>
                    <div class="other-amount-main" id="otherAmountBtnMain">Other amount</div>
                </div>
                
                <div class="donor-form-main" id="donorFormMain">
                    <div class="form-group-main">
                        <label class="form-label-main" for="donorNameMain">Full Name *</label>
                        <input type="text" id="donorNameMain" class="form-input-main" placeholder="Enter your name" required>
                    </div>
                    
                    <div class="form-group-main">
                        <label class="form-label-main" for="donorEmailMain">Email Address *</label>
                        <input type="email" id="donorEmailMain" class="form-input-main" placeholder="your@email.com" required>
                    </div>
                    
                    <div class="form-group-main">
                        <label class="form-label-main" for="donorPhoneMain">Phone Number *</label>
                        <input type="tel" id="donorPhoneMain" class="form-input-main" placeholder="+91 98765 43210" required>
                    </div>
                </div>
                
                <button class="submit-btn-main" id="submitBtnMain">JOIN TODAY</button>
                
                <div class="loading-main" id="loadingMain">
                    <div class="spinner-main"></div>
                    <p>Processing...</p>
                </div>
                
                <div class="impact-text-main" id="impactTextMain">
                    Your <span class="impact-amount-main">₹3,000</span> monthly donation can support <span class="impact-highlight-main">one artisan or farmer</span> with sustainability & climate resilience training every month. <span class="impact-highlight-main">85%</span> of funds go directly to programs.
                </div>
            </div>
        </div>
        
        <p class="security-notice-main">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
            </svg>
            Secure Payment · This site is protected by reCAPTCHA and the Google 
            <a href="#">Privacy Policy</a> and <a href="#">Terms of Service</a> apply.
        </p>
        
        <div class="transparency-banner-main">
            <div class="circle-badge-main">
                <span class="circle-number-main">85</span>
                <span class="circle-percent-main">%</span>
            </div>
            <div class="transparency-text-main">
                Thanks to generous private donors who fund our operational expenses, <strong>85% of your donation</strong> directly funds Integral Farming programs, artisan support, and climate resilience projects.
            </div>
        </div>
    </div>
</section>

<!-- Custom Amount Modal -->
<div class="modal-overlay-main" id="customModalMain">
    <div class="modal-content-main">
        <h3 class="modal-title-main">Enter Custom Amount</h3>
        <input type="text" id="customInputMain" class="custom-input-main" placeholder="₹" pattern="[0-9]*">
        <div class="modal-buttons-main">
            <button class="modal-btn-main modal-btn-cancel-main" id="cancelBtnMain">Cancel</button>
            <button class="modal-btn-main modal-btn-confirm-main" id="confirmBtnMain">Confirm</button>
        </div>
    </div>
</div>

<script>
(function() {
    // Razorpay Configuration
    const RAZORPAY_KEY_MAIN = 'rzp_test_YOUR_KEY_HERE';
    
    // Donation State
    let isMonthlyMain = true;
    let selectedAmountMain = 3000;
    let showingFormMain = false;
    
    // DOM Elements
    const onceBtnMain = document.getElementById('onceBtnMain');
    const monthlyBtnMain = document.getElementById('monthlyBtnMain');
    const sectionTitleMain = document.getElementById('sectionTitleMain');
    const amountBtnsMain = document.querySelectorAll('.amount-btn-main');
    const otherAmountBtnMain = document.getElementById('otherAmountBtnMain');
    const customModalMain = document.getElementById('customModalMain');
    const customInputMain = document.getElementById('customInputMain');
    const cancelBtnMain = document.getElementById('cancelBtnMain');
    const confirmBtnMain = document.getElementById('confirmBtnMain');
    const impactTextMain = document.getElementById('impactTextMain');
    const submitBtnMain = document.getElementById('submitBtnMain');
    const donorFormMain = document.getElementById('donorFormMain');
    const loadingMain = document.getElementById('loadingMain');
    
    // Toggle frequency
    onceBtnMain.addEventListener('click', () => {
        isMonthlyMain = false;
        onceBtnMain.classList.add('active');
        monthlyBtnMain.classList.remove('active');
        sectionTitleMain.textContent = 'Choose an amount to give';
        updateLabelsMain();
        updateImpactMain();
    });
    
    monthlyBtnMain.addEventListener('click', () => {
        isMonthlyMain = true;
        monthlyBtnMain.classList.add('active');
        onceBtnMain.classList.remove('active');
        sectionTitleMain.textContent = 'Choose an amount to give per month';
        updateLabelsMain();
        updateImpactMain();
    });
    
    // Amount selection
    amountBtnsMain.forEach(btn => {
        btn.addEventListener('click', () => {
            amountBtnsMain.forEach(b => b.classList.remove('selected'));
            otherAmountBtnMain.classList.remove('selected');
            btn.classList.add('selected');
            selectedAmountMain = parseInt(btn.dataset.amount);
            updateImpactMain();
        });
    });
    
    // Other amount
    otherAmountBtnMain.addEventListener('click', () => {
        customModalMain.classList.add('active');
        customInputMain.value = '';
        customInputMain.focus();
    });
    
    cancelBtnMain.addEventListener('click', () => {
        customModalMain.classList.remove('active');
    });
    
    confirmBtnMain.addEventListener('click', () => {
        const value = customInputMain.value.replace(/\D/g, '');
        if (value && parseInt(value) >= 100) {
            selectedAmountMain = parseInt(value);
            amountBtnsMain.forEach(b => b.classList.remove('selected'));
            otherAmountBtnMain.classList.add('selected');
            otherAmountBtnMain.innerHTML = '₹' + selectedAmountMain.toLocaleString('en-IN');
            customModalMain.classList.remove('active');
            updateImpactMain();
        } else {
            alert('Please enter an amount of at least ₹100');
        }
    });
    
    customModalMain.addEventListener('click', (e) => {
        if (e.target === customModalMain) customModalMain.classList.remove('active');
    });
    
    customInputMain.addEventListener('input', (e) => {
        e.target.value = e.target.value.replace(/\D/g, '');
    });
    
    function updateLabelsMain() {
        document.querySelectorAll('.amount-label-main').forEach(label => {
            label.textContent = isMonthlyMain ? 'INR/mo' : 'INR';
        });
    }
    
    function updateImpactMain() {
        const impacts = {
            500: 'can provide organic farming inputs for <span class="impact-highlight-main">one family</span>',
            1500: 'can support <span class="impact-highlight-main">skills training</span> for artisans',
            3000: 'can support <span class="impact-highlight-main">one artisan or farmer</span> with sustainability & climate resilience training',
            5000: 'can fund <span class="impact-highlight-main">women\'s training programs</span>'
        };
        
        const impact = impacts[selectedAmountMain] || 'will directly support our programs in North East India';
        const frequency = isMonthlyMain ? 'monthly donation' : 'donation';
        const period = isMonthlyMain ? 'every month' : '';
        
        impactTextMain.innerHTML = 'Your <span class="impact-amount-main">₹' + selectedAmountMain.toLocaleString('en-IN') + '</span> ' + frequency + ' ' + impact + ' ' + period + '. <span class="impact-highlight-main">85%</span> of funds go directly to programs.';
    }
    
    // Submit
    submitBtnMain.addEventListener('click', async () => {
        if (!showingFormMain) {
            donorFormMain.classList.add('active');
            showingFormMain = true;
            submitBtnMain.textContent = 'COMPLETE DONATION';
            donorFormMain.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        } else {
            await processDonationMain();
        }
    });
    
    async function processDonationMain() {
        const name = document.getElementById('donorNameMain').value.trim();
        const email = document.getElementById('donorEmailMain').value.trim();
        const phone = document.getElementById('donorPhoneMain').value.trim();
        
        if (!name || !email || !phone) {
            alert('Please fill in all required fields');
            return;
        }
        
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
            alert('Please enter a valid email address');
            return;
        }
        
        submitBtnMain.disabled = true;
        loadingMain.classList.add('active');
        
        const options = {
            key: RAZORPAY_KEY_MAIN,
            amount: selectedAmountMain * 100,
            currency: 'INR',
            name: 'Integral Foundation',
            description: (isMonthlyMain ? 'Monthly' : 'One-time') + ' Donation',
            prefill: { name, email, contact: phone },
            notes: { frequency: isMonthlyMain ? 'monthly' : 'one-time' },
            theme: { color: '#FFC700' },
            handler: function(response) {
                localStorage.setItem('lastDonation', JSON.stringify({
                    name, email, phone, amount: selectedAmountMain,
                    frequency: isMonthlyMain ? 'monthly' : 'one-time',
                    paymentId: response.razorpay_payment_id,
                    timestamp: new Date().toISOString()
                }));
                window.location.href = '/thank-you/?amount=' + selectedAmountMain + '&frequency=' + (isMonthlyMain ? 'monthly' : 'one-time');
            },
            modal: {
                ondismiss: function() {
                    submitBtnMain.disabled = false;
                    loadingMain.classList.remove('active');
                }
            }
        };
        
        new Razorpay(options).open();
    }
})();
</script>
{{ end }}
